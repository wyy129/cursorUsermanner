# 📖 使用示例

## 示例 1：查询基本账户信息

### 步骤

1. **获取 Token**
   
   访问 https://cursor.com/cn/dashboard，按 F12 打开开发者工具，在 Network 标签中找到任意请求，复制 Cookie 中的 WorkosCursorSessionToken 值。

   示例 Token 格式：
   ```
   user_01K6VZ40GJ6KWWKEKJ6F0E4ET1%3A%3AeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   ```

2. **输入 Token**
   
   在查询页面的输入框中粘贴完整的 Token

3. **点击查询**
   
   点击"查询"按钮，等待几秒钟

4. **查看结果**
   
   系统会显示：
   - 用户 ID
   - 订阅状态
   - 订阅计划
   - 订阅金额
   - 下次续费时间

---

## 示例 2：查看使用统计

### 查询结果示例

```
使用统计
├─ 快速请求：1,234 次
├─ 慢速请求：56 次
└─ 总请求：1,290 次
```

### 数据说明

- **快速请求**：快速响应的 API 调用
- **慢速请求**：需要较长处理时间的请求
- **总请求**：所有请求的总和

---

## 示例 3：查看原始数据

点击"原始数据"部分的"点击展开查看完整 JSON 数据"，可以看到完整的 API 返回数据：

```json
{
  "stripe": {
    "userId": "user_01K6VZ40GJ6KWWKEKJ6F0E4ET1",
    "subscription": {
      "status": "active",
      "plan": "pro",
      "amount": 2000,
      "current_period_end": 1764911732
    },
    "customer": {
      "email": "user@example.com",
      "name": "用户名"
    }
  },
  "usage": {
    "fast_requests": 1234,
    "slow_requests": 56,
    "total_requests": 1290
  }
}
```

---

## 常见查询场景

### 场景 1：检查订阅是否到期

查看"下次续费"时间，如果接近当前日期，说明订阅即将到期。

### 场景 2：监控使用量

定期查询使用统计，了解自己的 API 使用情况，避免超出限额。

### 场景 3：验证订阅状态

在购买或续费后，查询确认订阅状态是否为 "active"。

---

## API 调用示例

如果你想在自己的程序中使用这些 API，可以参考以下代码：

### JavaScript 示例

```javascript
// 查询订阅信息
async function getStripeInfo(token) {
    const response = await fetch('https://your-domain.vercel.app/api/stripe', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ token })
    });
    return await response.json();
}

// 查询使用统计
async function getUsageStats(token) {
    const endDate = Date.now();
    const startDate = endDate - (30 * 24 * 60 * 60 * 1000);
    
    const response = await fetch('https://your-domain.vercel.app/api/usage', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ 
            token,
            teamId: -1,
            startDate,
            endDate
        })
    });
    return await response.json();
}

// 使用示例
const token = 'your_token_here';
const [stripeData, usageData] = await Promise.all([
    getStripeInfo(token),
    getUsageStats(token)
]);

console.log('订阅信息:', stripeData);
console.log('使用统计:', usageData);
```

### Python 示例

```python
import requests
import time

def get_stripe_info(token):
    url = 'https://your-domain.vercel.app/api/stripe'
    response = requests.post(url, json={'token': token})
    return response.json()

def get_usage_stats(token):
    url = 'https://your-domain.vercel.app/api/usage'
    end_date = int(time.time() * 1000)
    start_date = end_date - (30 * 24 * 60 * 60 * 1000)
    
    payload = {
        'token': token,
        'teamId': -1,
        'startDate': start_date,
        'endDate': end_date
    }
    response = requests.post(url, json=payload)
    return response.json()

# 使用示例
token = 'your_token_here'
stripe_data = get_stripe_info(token)
usage_data = get_usage_stats(token)

print('订阅信息:', stripe_data)
print('使用统计:', usage_data)
```

---

## 错误处理

### 错误 1：Token 无效

```
❌ Cursor API 返回错误: 401
```

**解决方法**：重新获取 Token

### 错误 2：Token 过期

```
❌ 查询失败，请检查 Token 是否正确
```

**解决方法**：重新登录 Cursor，获取新的 Token

### 错误 3：网络错误

```
❌ 请求失败
```

**解决方法**：检查网络连接，稍后重试

---

## 最佳实践

1. **定期更换 Token**
   - 建议每周重新获取一次 Token
   - 不要在多个设备共享同一个 Token

2. **安全存储**
   - 不要将 Token 分享给他人
   - 不要在公共场所使用

3. **合理使用**
   - 避免频繁查询
   - 根据需要选择查询时间范围

4. **数据备份**
   - 定期导出原始数据（复制 JSON）
   - 保存历史查询记录

---

## 技巧与提示

💡 **快捷键**：在输入框中按 `Ctrl+A` 可以全选 Token

💡 **清空数据**：点击"清空"按钮可以清除输入框和保存的 Token

💡 **查看详情**：展开"原始数据"可以看到所有返回的字段

💡 **复制结果**：在原始数据区域，可以选中并复制 JSON 数据

---

需要更多帮助？查看 [README.md](./README.md) 或提交 [Issue](https://github.com/YOUR_USERNAME/cursor-usage-checker/issues)

